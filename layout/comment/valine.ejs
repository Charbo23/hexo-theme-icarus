<% if (!has_config('comment.app_id') || !has_config('comment.app_key')) { %>
<div class="notification is-danger">
    You forgot to set the <code>app_id</code> or <code>app_key</code> for Valine. Please set it in <code>_config.yml</code>.
</div>
<% } else { %>
<div id="valine-thread" class="content"></div>
<%- _js(cdn('leancloud-storage', '3.14.1', 'dist/av-min.js')) %>
<%- _js('js/Valine',true) %>

<script>
    
    var emoticon_list=["吐.png", "喷血.png", "狂汗.png", "不说话.png", "汗.png", "坐等.png", "献花.png", "不高兴.png", "中刀.png", "害羞.png", "皱眉.png", "小眼睛.png", "中指.png", "尴尬.png", "瞅你.png", "想一想.png", "中枪.png", "得意.png", "肿包.png", "扇耳光.png", "亲亲.png", "惊喜.png", "脸红.png", "无所谓.png", "便便.png", "愤怒.png", "蜡烛.png", "献黄瓜.png", "内伤.png", "投降.png", "观察.png", "看不见.png", "击掌.png", "抠鼻.png", "邪恶.png", "看热闹.png", "口水.png", "抽烟.png", "锁眉.png", "装大款.png", "吐舌.png", "无奈.png", "长草.png", "赞一个.png", "呲牙.png", "无语.png", "阴暗.png", "不出所料.png", "咽气.png", "期待.png", "高兴.png", "吐血倒地.png", "哭泣.png", "欢呼.png", "黑线.png", "喜极而泣.png", "喷水.png", "深思.png", "鼓掌.png", "暗地观察.png"];
    $(function() { 
        new Valine({
            av: AV, 
            el: '#valine-thread' ,
            notify: <%= get_config('comment.notify') %>,
            verify: <%= get_config('comment.verify') %>,
            app_id: '<%= get_config('comment.app_id') %>',
            app_key: '<%= get_config('comment.app_key') %>',
            placeholder: '<%= get_config('comment.placeholder') %>',
            lang: "zh-cn",
            maxNest: 3,
            pageSize: 5,
            // emoticon_url: 'https://charbo.me/alu',
            emoticon_url: 'https://cloud.panjunwen.com/alu',
            emoticon_list: emoticon_list,
        });
    });
    //todo: 过滤非数字字段，只允许跳转到评论
    if(window.location.hash){
        var target =decodeURIComponent(window.location.hash);
        var checkExist = setInterval(function() {
        if ($(target).length) {
            $('html, body').animate({scrollTop: $(target).offset().top}, 1000);
            clearInterval(checkExist);
        }
        }, 100);
    }  
 
</script>
<% } %>